/*
// Criação da tabela ORC com partições e clusterização para os dados
*/

CREATE TABLE IF NOT EXISTS schemaenem.orc_enem_2016
(
NU_INSCRICAO bigint,
NU_ANO bigint,
CO_MUNICIPIO_RESIDENCIA bigint,
NO_MUNICIPIO_RESIDENCIA String,
CO_UF_RESIDENCIA bigint,
SG_UF_RESIDENCIA String,
NU_IDADE bigint,
TP_SEXO String,
TP_ESTADO_CIVIL bigint,
TP_COR_RACA bigint,
TP_NACIONALIDADE bigint,
CO_MUNICIPIO_NASCIMENTO bigint,
NO_MUNICIPIO_NASCIMENTO String,
CO_UF_NASCIMENTO bigint,
TP_ST_CONCLUSAO bigint,
TP_ANO_CONCLUIU bigint,
TP_ESCOLA bigint,
TP_ENSINO Float,
IN_TREINEIRO bigint,
CO_ESCOLA Float,
CO_MUNICIPIO_ESC Float,
NO_MUNICIPIO_ESC Float,
CO_UF_ESC Float,
SG_UF_ESC Float,
TP_DEPENDENCIA_ADM_ESC Float,
TP_LOCALIZACAO_ESC Float,
TP_SIT_FUNC_ESC Float,
IN_BAIXA_VISAO bigint,
IN_CEGUEIRA bigint,
IN_SURDEZ bigint,
IN_DEFICIENCIA_AUDITIVA bigint,
IN_SURDO_CEGUEIRA bigint,
IN_DEFICIENCIA_FISICA bigint,
IN_DEFICIENCIA_MENTAL bigint,
IN_DEFICIT_ATENCAO bigint,
IN_DISLEXIA bigint,
IN_DISCALCULIA bigint,
IN_AUTISMO bigint,
IN_VISAO_MONOCULAR bigint,
IN_OUTRA_DEF bigint,
IN_SABATISTA bigint,
IN_GESTANTE bigint,
IN_LACTANTE bigint,
IN_IDOSO bigint,
IN_ESTUDA_CLASSE_HOSPITALAR bigint,
IN_SEM_RECURSO bigint,
IN_BRAILLE bigint,
IN_AMPLIADA_24 bigint,
IN_AMPLIADA_18 bigint,
IN_LEDOR bigint,
IN_ACESSO bigint,
IN_TRANSCRICAO bigint,
IN_LIBRAS bigint,
IN_LEITURA_LABIAL bigint,
IN_MESA_CADEIRA_RODAS bigint,
IN_MESA_CADEIRA_SEPARADA bigint,
IN_APOIO_PERNA bigint,
IN_GUIA_INTERPRETE bigint,
IN_MACA bigint,
IN_COMPUTADOR bigint,
IN_CADEIRA_ESPECIAL bigint,
IN_CADEIRA_CANHOTO bigint,
IN_CADEIRA_ACOLCHOADA bigint,
IN_PROVA_DEITADO bigint,
IN_MOBILIARIO_OBESO bigint,
IN_LAMINA_OVERLAY bigint,
IN_PROTETOR_AURICULAR bigint,
IN_MEDIDOR_GLICOSE bigint,
IN_MAQUINA_BRAILE bigint,
IN_SOROBAN bigint,
IN_MARCA_PASSO bigint,
IN_SONDA bigint,
IN_MEDICAMENTOS bigint,
IN_SALA_INDIVIDUAL bigint,
IN_SALA_ESPECIAL bigint,
IN_SALA_ACOMPANHANTE bigint,
IN_MOBILIARIO_ESPECIFICO bigint,
IN_MATERIAL_ESPECIFICO bigint,
IN_NOME_SOCIAL bigint,
IN_CERTIFICADO bigint,
NO_ENTIDADE_CERTIFICACAO Float,
CO_UF_ENTIDADE_CERTIFICACAO Float,
SG_UF_ENTIDADE_CERTIFICACAO Float,
CO_MUNICIPIO_PROVA bigint,
NO_MUNICIPIO_PROVA String,
CO_UF_PROVA bigint,
SG_UF_PROVA String,
TP_PRESENCA_CN bigint,
TP_PRESENCA_CH bigint,
TP_PRESENCA_LC bigint,
TP_PRESENCA_MT bigint,
CO_PROVA_CN Float,
CO_PROVA_CH Float,
CO_PROVA_LC Float,
CO_PROVA_MT Float,
NU_NOTA_CN Float,
NU_NOTA_CH Float,
NU_NOTA_LC Float,
NU_NOTA_MT Float,
TX_RESPOSTAS_CN String,
TX_RESPOSTAS_CH String,
TX_RESPOSTAS_LC String,
TX_RESPOSTAS_MT String,
TP_LINGUA bigint,
TX_GABARITO_CN String,
TX_GABARITO_CH String,
TX_GABARITO_LC String,
TX_GABARITO_MT String,
TP_STATUS_REDACAO Float,
NU_NOTA_COMP1 Float,
NU_NOTA_COMP2 Float,
NU_NOTA_COMP3 Float,
NU_NOTA_COMP4 Float,
NU_NOTA_COMP5 Float,
NU_NOTA_REDACAO Float,
Q001 String,
Q002 String,
Q003 String,
Q004 String,
Q005 bigint,
Q006 String,
Q007 String,
Q008 String,
Q009 String,
Q010 String,
Q011 String,
Q012 String,
Q013 String,
Q014 String,
Q015 String,
Q016 String,
Q017 String,
Q018 String,
Q019 String,
Q020 String,
Q021 String,
Q022 String,
Q023 String,
Q024 String,
Q025 String,
Q026 String,
Q027 Float,
Q028 Float,
Q029 Float,
Q030 Float,
Q031 Float,
Q032 Float,
Q033 Float,
Q034 bigint,
Q035 bigint,
Q036 bigint,
Q037 bigint,
Q038 bigint,
Q039 bigint,
Q040 bigint,
Q041 Float,
Q042 String,
Q043 String,
Q044 String,
Q045 String,
Q046 String,
Q047 String,
Q048 String,
Q049 String,
Q050 String
)
PARTITIONED BY (SG_UF_NASCIMENTO STRING)
CLUSTERED BY (TP_SEXO) INTO 2 BUCKETS
STORED AS ORC
TBLPROPERTIES (
'orc.compress'='SNAPPY'
);